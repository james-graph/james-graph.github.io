"use strict";var app=angular.module("jamesApp",["firebase"]);app.controller("GraphCtrl",["$scope","$firebaseArray",function(a,b){function c(a,b){var e=0;angular.forEach(a,function(a,f){if("object"==typeof a&&void 0!==typeof a&&!String(f).startsWith("$")){e+=1;var g=f,h=d(6);a.nodeId=h;var i={id:h,name:g,data:a,children:[]};b.children.push(i),c(a,i)}})}function d(a){return Math.round(Math.pow(36,a+1)-Math.random()*Math.pow(36,a)).toString(36).slice(1)}function e(b){var c,d,e,g;!function(){var a=navigator.userAgent,b=a.match(/iPhone/i)||a.match(/iPad/i),f=typeof HTMLCanvasElement,h="object"==f||"function"==f,i=h&&"function"==typeof document.createElement("canvas").getContext("2d").fillText;c=!h||i&&!b?"Native":"HTML",e="Native"==c,d=h,g=!(b||!h)}(),f=new $jit.RGraph({injectInto:"infovis",background:{CanvasStyles:{strokeStyle:"#555"}},Node:{dim:20,color:"#772277"},Edge:{color:"#772277"},levelDistance:100,duration:1e3,onCreateLabel:function(b,c){b.innerHTML=c.name;var d=b.style;d.fontSize="0.8em",d.color="#fff",d.cursor="pointer",b.onclick=function(){angular.forEach(c.data,function(a,b){"object"!=typeof a||void 0===typeof a||String(b).startsWith("$")||(c.data[b].object="object")}),a.nodeCentral=c.data,a.$apply(),f.onClick(c.id,{hideLabels:!1})}},onPlaceLabel:function(a,b){var c=a.style,d=parseInt(c.left),e=a.offsetWidth;c.left=d-e/2+"px",c.display=""}}),f.loadJSON(b),f.refresh()}var f={};a.load=!0,a.begin=function(){window.location.reload()},a.startExtraction=function(){a.load=!1,document.getElementById("infovis").innerHTML="";try{if(a.jsonReference&&a.firebaseReference||!a.jsonReference&&!a.firebaseReference)Materialize.toast("To proceed fill only one of the fields",6e3),a.load=!0;else if(a.jsonReference){var d=JSON.parse(a.jsonReference);if(d){var f={id:"root",name:"ROOT",data:d,children:[]};c(d,f),e(f),a.load=!0,a.nextNode(f.data)}}else{var g=b(new Firebase(a.firebaseReference));g.$loaded().then(function(b){if(b){var d={id:"root",name:"ROOT",data:{ROOT:b},children:[]};c(b,d),e(d),a.load=!0,a.nextNode(d.data)}})}}catch(h){Materialize.toast(h,6e3),a.load=!0}},a.nextNode=function(b){angular.forEach(b,function(a,c){"object"!=typeof a||void 0===typeof a||String(c).startsWith("$")||(b[c].object="object")}),delete b.object,a.nodeCentral=b,b.nodeId&&f.onClick(b.nodeId,{hideLabels:!1})}}]);